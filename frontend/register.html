<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AgriFusion - Farmer Registration</title>
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #a8e063, #56ab2f);
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
      }
      .container {
        background: #fff;
        padding: 30px 40px;
        border-radius: 16px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        width: 500px;
        max-height: 95vh;
        overflow-y: auto;
      }
      h2 {
        text-align: center;
        color: #2e7d32;
        margin-bottom: 20px;
      }
      h3 {
        color: #388e3c;
        border-bottom: 2px solid #c8e6c9;
        padding-bottom: 5px;
        margin-top: 20px;
      }
      form {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      input,
      select {
        padding: 10px;
        border-radius: 6px;
        border: 1px solid #ccc;
        font-size: 15px;
      }
      button {
        background: #2e7d32;
        color: white;
        border: none;
        padding: 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        transition: background 0.3s;
      }
      button:hover {
        background: #256627;
      }
      .success,
      .error {
        text-align: center;
        font-weight: bold;
        margin-top: 10px;
      }
      .success {
        color: green;
      }
      .error {
        color: red;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>üåæ Farmer Registration</h2>
      <form id="registerForm">
        <!-- üßç Basic Information -->
        <h3>Basic Information</h3>
        <input type="text" id="username" placeholder="Username" required />
        <input type="password" id="password" placeholder="Password" required />
        <input type="text" id="name" placeholder="Full Name" required />
        <input type="email" id="email" placeholder="Email" required />
        <input type="text" id="phone" placeholder="Phone Number" required />
        <input type="number" id="age" placeholder="Age" required />
        <input type="text" id="address" placeholder="Address" required />

        <!-- üåæ Land Details -->
        <h3>Land Details</h3>
        <label for="soilType">Soil Type:</label>
        <select id="soilType" required>
          <option value="">-- Select Soil Type --</option>
          <option value="Clay">Clay</option>
          <option value="Loam">Loam</option>
          <option value="Sandy">Sandy</option>
        </select>

        <input
          type="text"
          id="landSize"
          placeholder="Land Size (in acres)"
          required
        />

        <label for="waterSource">Water Source Available:</label>
        <select id="waterSource" required>
          <option value="">-- Select Water Source --</option>
          <option value="River">River</option>
          <option value="Well">Well</option>
          <option value="Tank Channels">Tank Channels</option>
          <option value="Borewell">Borewell</option>
        </select>

        <input
          type="text"
          id="previousCrop"
          placeholder="Previous Crop"
          required
        />
        <input
          type="text"
          id="irrigationPreference"
          placeholder="Irrigation Preference"
          required
        />

        <!-- üå± Soil Details -->
        <h3>Soil Details</h3>
        <input
          type="number"
          step="0.01"
          id="N"
          placeholder="Nitrogen (N)"
          required
        />
        <input
          type="number"
          step="0.01"
          id="P"
          placeholder="Phosphorus (P)"
          required
        />
        <input
          type="number"
          step="0.01"
          id="K"
          placeholder="Potassium (K)"
          required
        />
        <input
          type="number"
          step="0.1"
          id="temperature"
          placeholder="Temperature (¬∞C)"
          required
        />
        <input
          type="number"
          step="0.1"
          id="humidity"
          placeholder="Humidity (%)"
          required
        />
        <input
          type="number"
          step="0.1"
          id="ph"
          placeholder="pH Value"
          required
        />
        <input
          type="number"
          step="0.1"
          id="soilMoisture"
          placeholder="Soil Moisture (%)"
          required
        />

        <!-- üåæ Crop Selection -->
        <h3>Crop Chosen</h3>
        <label for="cropChosen">Select Crop:</label>
        <select id="cropChosen" required>
          <option value="">-- Select Crop --</option>
          <option value="Potato">Potato</option>
          <option value="Pepper">Pepper</option>
          <option value="Maize">Maize</option>
          <option value="Orange">Orange</option>
          <option value="Grapes">Grapes</option>
        </select>

        <button type="submit">Register</button>
      </form>
      <div id="message"></div>
    </div>

    <script>
      document
        .getElementById("registerForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const userData = {
            username: document.getElementById("username").value,
            password: document.getElementById("password").value,
            name: document.getElementById("name").value,
            email: document.getElementById("email").value,
            phone: document.getElementById("phone").value,
            age: document.getElementById("age").value,
            address: document.getElementById("address").value,

            landDetails: {
              soilType: document.getElementById("soilType").value,
              landSize: document.getElementById("landSize").value,
              waterResource: document.getElementById("waterSource").value,
              previousCrop: document.getElementById("previousCrop").value,
              irrigationPreference: document.getElementById(
                "irrigationPreference"
              ).value,
            },
            soilDetails: {
              N: parseFloat(document.getElementById("N").value), // Added parseFloat
              P: parseFloat(document.getElementById("P").value),
              K: parseFloat(document.getElementById("K").value),
              temperature: parseFloat(
                document.getElementById("temperature").value
              ),
              humidity: parseFloat(document.getElementById("humidity").value),
              ph: parseFloat(document.getElementById("ph").value),
              moisture: parseFloat(
                document.getElementById("soilMoisture").value
              ),
            },
            cropChosen: document.getElementById("cropChosen").value,
          };

          try {
            const response = await fetch("http://localhost:5000/register", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(userData),
            });

            const data = await response.json();
            const messageDiv = document.getElementById("message");

            if (response.ok) {
              messageDiv.textContent = "‚úÖ Registration successful!";
              messageDiv.className = "success";
              document.getElementById("registerForm").reset();
              setTimeout(() => (window.location.href = "login.html"), 1500);
            } else {
              messageDiv.textContent = "‚ùå " + data.message;
              messageDiv.className = "error";
            }
          } catch (err) {
            console.error("Error:", err);
            const messageDiv = document.getElementById("message");
            messageDiv.textContent = "‚ùå Failed to connect to server!";
            messageDiv.className = "error";
          }
        });
    </script>
  </body>
</html>
